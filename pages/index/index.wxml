<!--index.wxml-->
<view class="container">
  <!-- Â§¥ÈÉ®ÂÆö‰Ωç‰ø°ÊÅØ -->
  <view class="header">
    <view class="location">
      <text class="city">{{cityName}}</text>
      <text class="date">{{today}} {{week}}</text>
    </view>
    <view class="refresh" bindtap="refreshData">
      <text class="iconfont">üîÑ</text>
    </view>
  </view>

  <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading">Êï∞ÊçÆÂä†ËΩΩ‰∏≠...</view>
  </view>

  <!-- ÈîôËØØÊèêÁ§∫ -->
  <view class="error-container" wx:if="{{error}}">
    <view class="error">{{error}}</view>
    <view class="retry" bindtap="getWeatherData">ÈáçËØï</view>
  </view>

  <!-- Â§©Ê∞îÂíåÁ©∫Ê∞îË¥®Èáè‰ø°ÊÅØ -->
  <block wx:if="{{!loading && !error && weatherInfo && airQuality}}">
    <!-- Â§©Ê∞î‰ø°ÊÅØ -->
    <view class="weather-card">
      <view class="weather-main">
        <view class="temp-wrap">
          <text class="temp">{{weatherInfo.temp}}</text>
          <text class="temp-unit">¬∞C</text>
        </view>
        <view class="weather-desc">
          <view class="weather-icon">
            <text class="weather-text">{{weatherInfo.text}}</text>
          </view>
          <view class="weather-feel">‰ΩìÊÑüÊ∏©Â∫¶ {{weatherInfo.feelsLike}}¬∞C</view>
        </view>
      </view>
      <view class="weather-detail">
        <view class="detail-item">
          <text class="detail-label">ÊπøÂ∫¶</text>
          <text class="detail-value">{{weatherInfo.humidity}}%</text>
        </view>
        <view class="detail-item">
          <text class="detail-label">È£éÂêë</text>
          <text class="detail-value">{{weatherInfo.windDir}}</text>
        </view>
        <view class="detail-item">
          <text class="detail-label">È£éÈÄü</text>
          <text class="detail-value">{{weatherInfo.windSpeed}}km/h</text>
        </view>
        <view class="detail-item">
          <text class="detail-label">Ê∞îÂéã</text>
          <text class="detail-value">{{weatherInfo.pressure}}hPa</text>
        </view>
      </view>
    </view>

    <!-- Á©∫Ê∞îË¥®Èáè‰ø°ÊÅØ -->
    <view class="air-card">
      <view class="air-title">Á©∫Ê∞îË¥®Èáè</view>
      <view class="air-content">
        <view class="air-value-container" style="background-color: {{aqiInfo.color}}">
          <text class="air-value">{{airQuality.aqi}}</text>
          <text class="air-level">{{aqiInfo.level}}</text>
        </view>
        <view class="air-detail">
          <view class="air-item">
            <text class="air-label">PM2.5</text>
            <text class="air-item-value">{{airQuality.pm2p5}}</text>
          </view>
          <view class="air-item">
            <text class="air-label">PM10</text>
            <text class="air-item-value">{{airQuality.pm10}}</text>
          </view>
          <view class="air-item">
            <text class="air-label">NO‚ÇÇ</text>
            <text class="air-item-value">{{airQuality.no2}}</text>
          </view>
          <view class="air-item">
            <text class="air-label">SO‚ÇÇ</text>
            <text class="air-item-value">{{airQuality.so2}}</text>
          </view>
          <view class="air-item">
            <text class="air-label">O‚ÇÉ</text>
            <text class="air-item-value">{{airQuality.o3}}</text>
          </view>
          <view class="air-item">
            <text class="air-label">CO</text>
            <text class="air-item-value">{{airQuality.co}}</text>
          </view>
        </view>
      </view>
      <view class="air-suggestion">
        <text>{{aqiInfo.suggestion}}</text>
      </view>
    </view>

    <!-- Ê∞îÊ∏©ÂíåÊπøÂ∫¶ÂõæË°® -->
    <view class="chart-container">
      <view class="chart-box">
        <canvas canvas-id="tempChart" id="tempChart" class="temp-chart" style="width: 320px; height: 200px;"></canvas>
      </view>
      <view class="chart-box">
        <canvas canvas-id="humidityChart" id="humidityChart" class="humidity-chart" style="width: 320px; height: 200px;"></canvas>
      </view>
    </view>

    <!-- Êõ¥Êñ∞Êó∂Èó¥ -->
    <view class="update-time" wx:if="{{showUpdateTime}}">
      <text>Êõ¥Êñ∞Êó∂Èó¥: {{weatherInfo.obsTime}}</text>
    </view>
  </block>
</view>
